import{m as B,i as p,e as A}from"./api-BUtp0CYo.js";import{_ as v}from"./UploadScore.vue_vue_type_script_setup_true_lang-CP1pGWmg.js";import{d as F,r as n,i as L,E as V,c as f,g as i,h as g,a as h,k as x,w as b,b as m,F as w,z as $,e as z,o,_ as I}from"./index-CnQ5Sg1B.js";const M=F({__name:"Score",setup(j){const l=n(""),t=n(""),u=n(""),d=n(0),a=n([]);let s;L(async()=>{if(s=history.state.song,l.value=s.id,u.value=s.name,d.value=s.is_extend,t.value=c(s.score),a.value.push(t.value),d.value){const e=await B({path:t.value,is_extend:2,sort:{extend:1}}).catch(_);e==null||e.rows.forEach(({path:r})=>{a.value.push(c(r))})}});const k=async e=>{a.value.length>1&&await A(l.value,{is_extend:0}).catch(_),t.value=c(e),a.value=[t.value]},y=async e=>{a.value.push(c(e))},c=e=>`${e}?t=${Date.now()}`;function _(e){return V({message:e.msg,type:"error"}),Promise.reject(e)}return(e,r)=>{const S=m("el-button"),C=m("router-link"),E=m("el-image");return o(),f(w,null,[x(p)()?(o(),i(v,{key:0,class:"upload",btnName:"更换",btnClass:"global-float-button",id:l.value,name:u.value,path:t.value,onSuccess:k},null,8,["id","name","path"])):g("",!0),h(C,{to:{name:"Index"}},{default:b(()=>[h(S,{class:"global-float-button",type:"warning"},{default:b(()=>r[0]||(r[0]=[z("返回")])),_:1})]),_:1}),(o(!0),f(w,null,$(a.value,N=>(o(),i(E,{src:N,"z-index":999,"preview-src-list":a.value},null,8,["src","preview-src-list"]))),256)),x(p)()?(o(),i(v,{key:1,class:"addBtn",btnName:"添加",id:l.value,name:u.value,extend:a.value.length,onSuccess:y},null,8,["id","name","extend"])):g("",!0)],64)}}}),q=I(M,[["__scopeId","data-v-2ec5a2ab"]]);export{q as default};
