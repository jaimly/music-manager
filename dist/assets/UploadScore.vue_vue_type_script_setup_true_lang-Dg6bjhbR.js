import{j as C,d as M}from"./api-DkxZQJ3Z.js";import{d as N,r as d,u as t,h as T,b as u,k as p,E as n,w as m,a as L,e as x,t as F,B as j,o as E}from"./index-BXZU-0Ea.js";const q=N({__name:"UploadScore",props:{btnName:{type:String,default:"更换"},btnNameModifiers:{},btnClass:{type:String},btnClassModifiers:{},btnType:{type:String,default:"primary"},btnTypeModifiers:{},isBtnLink:{type:Boolean,default:!1},isBtnLinkModifiers:{},id:{type:String,required:!0},idModifiers:{},name:{type:String,required:!0},nameModifiers:{},onSuccess:{type:Function},onSuccessModifiers:{}},emits:["update:btnName","update:btnClass","update:btnType","update:isBtnLink","update:id","update:name","update:onSuccess"],setup(e){const f=d(window.localStorage.getItem("password")),o=d(!1),b=t(e,"btnName"),y=t(e,"btnClass"),g=t(e,"btnType"),S=t(e,"isBtnLink"),v=t(e,"id"),r=t(e,"name"),i=t(e,"onSuccess"),k=async(a,h,l)=>{var c;o.value=!1;const s=(c=a.data)==null?void 0:c.path;await M(v.value,{score:s}).then(()=>{n({message:"更新成功！",type:"success"}),i==null||i.value(s)}).catch(B),l.splice(0,1)},w=a=>{n({message:`上传失败：${r}`,type:"error"}),console.trace(a)};function B(a){n({message:a.msg,type:"warning"})}return(a,h)=>{const l=u("el-button"),s=u("el-upload");return E(),T(s,{action:p(C)(),accept:".jpg,.jpeg,.png",limit:1,"show-file-list":!1,"auto-upload":!0,headers:{password:f.value},data:{name:r.value,category:"score"},"on-success":k,"on-error":w,"before-upload":()=>(p(n)({message:"开始上传，请等候...",type:"info"}),o.value=!0,!0)},{default:m(()=>[L(l,{type:g.value,class:j(y.value),link:S.value,disabled:o.value},{default:m(()=>[x(F(b.value),1)]),_:1},8,["type","class","link","disabled"])]),_:1},8,["action","headers","data","before-upload"])}}});export{q as _};
